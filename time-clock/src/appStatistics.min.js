const config={url:"http://log.ktj.wankacn.com"};var CryptoJS=CryptoJS||function(t,e){var i={},n=i.lib={},r=function(){},s=n.Base={extend:function(t){r.prototype=this;var e=new r;return t&&e.mixIn(t),e.hasOwnProperty("init")||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},o=n.WordArray=s.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||c).stringify(this)},concat:function(t){var e=this.words,i=t.words,n=this.sigBytes;if(t=t.sigBytes,this.clamp(),n%4)for(var r=0;r<t;r++)e[n+r>>>2]|=(i[r>>>2]>>>24-r%4*8&255)<<24-(n+r)%4*8;else if(65535<i.length)for(r=0;r<t;r+=4)e[n+r>>>2]=i[r>>>2];else e.push.apply(e,i);return this.sigBytes+=t,this},clamp:function(){var e=this.words,i=this.sigBytes;e[i>>>2]&=4294967295<<32-i%4*8,e.length=t.ceil(i/4)},clone:function(){var t=s.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var i=[],n=0;n<e;n+=4)i.push(4294967296*t.random()|0);return new o.init(i,e)}}),a=i.enc={},c=a.Hex={stringify:function(t){var e=t.words;t=t.sigBytes;for(var i=[],n=0;n<t;n++){var r=e[n>>>2]>>>24-n%4*8&255;i.push((r>>>4).toString(16)),i.push((15&r).toString(16))}return i.join("")},parse:function(t){for(var e=t.length,i=[],n=0;n<e;n+=2)i[n>>>3]|=parseInt(t.substr(n,2),16)<<24-n%8*4;return new o.init(i,e/2)}},u=a.Latin1={stringify:function(t){var e=t.words;t=t.sigBytes;for(var i=[],n=0;n<t;n++)i.push(String.fromCharCode(e[n>>>2]>>>24-n%4*8&255));return i.join("")},parse:function(t){for(var e=t.length,i=[],n=0;n<e;n++)i[n>>>2]|=(255&t.charCodeAt(n))<<24-n%4*8;return new o.init(i,e)}},h=a.Utf8={stringify:function(t){try{return decodeURIComponent(escape(u.stringify(t)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(t){return u.parse(unescape(encodeURIComponent(t)))}},f=n.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=h.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var i=this._data,n=i.words,r=i.sigBytes,s=this.blockSize,a=r/(4*s);if(e=(a=e?t.ceil(a):t.max((0|a)-this._minBufferSize,0))*s,r=t.min(4*e,r),e){for(var c=0;c<e;c+=s)this._doProcessBlock(n,c);c=n.splice(0,e),i.sigBytes-=r}return new o.init(c,r)},clone:function(){var t=s.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});n.Hasher=f.extend({cfg:s.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,i){return new t.init(i).finalize(e)}},_createHmacHelper:function(t){return function(e,i){return new p.HMAC.init(t,i).finalize(e)}}});var p=i.algo={};return i}(Math);!function(){var t=CryptoJS,e=t.lib.WordArray;t.enc.Base64={stringify:function(t){var e=t.words,i=t.sigBytes,n=this._map;t.clamp(),t=[];for(var r=0;r<i;r+=3)for(var s=(e[r>>>2]>>>24-r%4*8&255)<<16|(e[r+1>>>2]>>>24-(r+1)%4*8&255)<<8|e[r+2>>>2]>>>24-(r+2)%4*8&255,o=0;4>o&&r+.75*o<i;o++)t.push(n.charAt(s>>>6*(3-o)&63));if(e=n.charAt(64))for(;t.length%4;)t.push(e);return t.join("")},parse:function(t){var i=t.length,n=this._map;(r=n.charAt(64))&&(-1!=(r=t.indexOf(r))&&(i=r));for(var r=[],s=0,o=0;o<i;o++)if(o%4){var a=n.indexOf(t.charAt(o-1))<<o%4*2,c=n.indexOf(t.charAt(o))>>>6-o%4*2;r[s>>>2]|=(a|c)<<24-s%4*8,s++}return e.create(r,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(t){function e(t,e,i,n,r,s,o){return((t=t+(e&i|~e&n)+r+o)<<s|t>>>32-s)+e}function i(t,e,i,n,r,s,o){return((t=t+(e&n|i&~n)+r+o)<<s|t>>>32-s)+e}function n(t,e,i,n,r,s,o){return((t=t+(e^i^n)+r+o)<<s|t>>>32-s)+e}function r(t,e,i,n,r,s,o){return((t=t+(i^(e|~n))+r+o)<<s|t>>>32-s)+e}for(var s=CryptoJS,o=(c=s.lib).WordArray,a=c.Hasher,c=s.algo,u=[],h=0;64>h;h++)u[h]=4294967296*t.abs(t.sin(h+1))|0;c=c.MD5=a.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,s){for(var o=0;16>o;o++){var a=t[c=s+o];t[c]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}o=this._hash.words;var c=t[s+0],h=(a=t[s+1],t[s+2]),f=t[s+3],p=t[s+4],d=t[s+5],l=t[s+6],_=t[s+7],g=t[s+8],m=t[s+9],y=t[s+10],v=t[s+11],S=t[s+12],k=t[s+13],w=t[s+14],B=t[s+15],C=e(C=o[0],P=o[1],z=o[2],x=o[3],c,7,u[0]),x=e(x,C,P,z,a,12,u[1]),z=e(z,x,C,P,h,17,u[2]),P=e(P,z,x,C,f,22,u[3]);C=e(C,P,z,x,p,7,u[4]),x=e(x,C,P,z,d,12,u[5]),z=e(z,x,C,P,l,17,u[6]),P=e(P,z,x,C,_,22,u[7]),C=e(C,P,z,x,g,7,u[8]),x=e(x,C,P,z,m,12,u[9]),z=e(z,x,C,P,y,17,u[10]),P=e(P,z,x,C,v,22,u[11]),C=e(C,P,z,x,S,7,u[12]),x=e(x,C,P,z,k,12,u[13]),z=e(z,x,C,P,w,17,u[14]),C=i(C,P=e(P,z,x,C,B,22,u[15]),z,x,a,5,u[16]),x=i(x,C,P,z,l,9,u[17]),z=i(z,x,C,P,v,14,u[18]),P=i(P,z,x,C,c,20,u[19]),C=i(C,P,z,x,d,5,u[20]),x=i(x,C,P,z,y,9,u[21]),z=i(z,x,C,P,B,14,u[22]),P=i(P,z,x,C,p,20,u[23]),C=i(C,P,z,x,m,5,u[24]),x=i(x,C,P,z,w,9,u[25]),z=i(z,x,C,P,f,14,u[26]),P=i(P,z,x,C,g,20,u[27]),C=i(C,P,z,x,k,5,u[28]),x=i(x,C,P,z,h,9,u[29]),z=i(z,x,C,P,_,14,u[30]),C=n(C,P=i(P,z,x,C,S,20,u[31]),z,x,d,4,u[32]),x=n(x,C,P,z,g,11,u[33]),z=n(z,x,C,P,v,16,u[34]),P=n(P,z,x,C,w,23,u[35]),C=n(C,P,z,x,a,4,u[36]),x=n(x,C,P,z,p,11,u[37]),z=n(z,x,C,P,_,16,u[38]),P=n(P,z,x,C,y,23,u[39]),C=n(C,P,z,x,k,4,u[40]),x=n(x,C,P,z,c,11,u[41]),z=n(z,x,C,P,f,16,u[42]),P=n(P,z,x,C,l,23,u[43]),C=n(C,P,z,x,m,4,u[44]),x=n(x,C,P,z,S,11,u[45]),z=n(z,x,C,P,B,16,u[46]),C=r(C,P=n(P,z,x,C,h,23,u[47]),z,x,c,6,u[48]),x=r(x,C,P,z,_,10,u[49]),z=r(z,x,C,P,w,15,u[50]),P=r(P,z,x,C,d,21,u[51]),C=r(C,P,z,x,S,6,u[52]),x=r(x,C,P,z,f,10,u[53]),z=r(z,x,C,P,y,15,u[54]),P=r(P,z,x,C,a,21,u[55]),C=r(C,P,z,x,g,6,u[56]),x=r(x,C,P,z,B,10,u[57]),z=r(z,x,C,P,l,15,u[58]),P=r(P,z,x,C,k,21,u[59]),C=r(C,P,z,x,p,6,u[60]),x=r(x,C,P,z,v,10,u[61]),z=r(z,x,C,P,h,15,u[62]),P=r(P,z,x,C,m,21,u[63]);o[0]=o[0]+C|0,o[1]=o[1]+P|0,o[2]=o[2]+z|0,o[3]=o[3]+x|0},_doFinalize:function(){var e=this._data,i=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;i[r>>>5]|=128<<24-r%32;var s=t.floor(n/4294967296);for(i[15+(r+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),i[14+(r+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(i.length+1),this._process(),i=(e=this._hash).words,n=0;4>n;n++)r=i[n],i[n]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8);return e},clone:function(){var t=a.clone.call(this);return t._hash=this._hash.clone(),t}}),s.MD5=a._createHelper(c),s.HmacMD5=a._createHmacHelper(c)}(Math),function(){var t,e=CryptoJS,i=(t=e.lib).Base,n=t.WordArray,r=(t=e.algo).EvpKDF=i.extend({cfg:i.extend({keySize:4,hasher:t.MD5,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var i=(a=this.cfg).hasher.create(),r=n.create(),s=r.words,o=a.keySize,a=a.iterations;s.length<o;){c&&i.update(c);var c=i.update(t).finalize(e);i.reset();for(var u=1;u<a;u++)c=i.finalize(c),i.reset();r.concat(c)}return r.sigBytes=4*o,r}});e.EvpKDF=function(t,e,i){return r.create(i).compute(t,e)}}(),CryptoJS.lib.Cipher||function(t){var e=(d=CryptoJS).lib,i=e.Base,n=e.WordArray,r=e.BufferedBlockAlgorithm,s=d.enc.Base64,o=d.algo.EvpKDF,a=e.Cipher=r.extend({cfg:i.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,i){this.cfg=this.cfg.extend(i),this._xformMode=t,this._key=e,this.reset()},reset:function(){r.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(t){return{encrypt:function(e,i,n){return("string"==typeof i?l:p).encrypt(t,e,i,n)},decrypt:function(e,i,n){return("string"==typeof i?l:p).decrypt(t,e,i,n)}}}});e.StreamCipher=a.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var c=d.mode={},u=function(t,e,i){var n=this._iv;n?this._iv=void 0:n=this._prevBlock;for(var r=0;r<i;r++)t[e+r]^=n[r]},h=(e.BlockCipherMode=i.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}})).extend();h.Encryptor=h.extend({processBlock:function(t,e){var i=this._cipher,n=i.blockSize;u.call(this,t,e,n),i.encryptBlock(t,e),this._prevBlock=t.slice(e,e+n)}}),h.Decryptor=h.extend({processBlock:function(t,e){var i=this._cipher,n=i.blockSize,r=t.slice(e,e+n);i.decryptBlock(t,e),u.call(this,t,e,n),this._prevBlock=r}}),c=c.CBC=h,h=(d.pad={}).Pkcs7={pad:function(t,e){for(var i,r=(i=(i=4*e)-t.sigBytes%i)<<24|i<<16|i<<8|i,s=[],o=0;o<i;o+=4)s.push(r);i=n.create(s,i),t.concat(i)},unpad:function(t){t.sigBytes-=255&t.words[t.sigBytes-1>>>2]}},e.BlockCipher=a.extend({cfg:a.cfg.extend({mode:c,padding:h}),reset:function(){a.reset.call(this);var t=(e=this.cfg).iv,e=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var i=e.createEncryptor;else i=e.createDecryptor,this._minBufferSize=1;this._mode=i.call(e,this,t&&t.words)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){t.pad(this._data,this.blockSize);var e=this._process(!0)}else e=this._process(!0),t.unpad(e);return e},blockSize:4});var f=e.CipherParams=i.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}}),p=(c=(d.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext;return((t=t.salt)?n.create([1398893684,1701076831]).concat(t).concat(e):e).toString(s)},parse:function(t){var e=(t=s.parse(t)).words;if(1398893684==e[0]&&1701076831==e[1]){var i=n.create(e.slice(2,4));e.splice(0,4),t.sigBytes-=16}return f.create({ciphertext:t,salt:i})}},e.SerializableCipher=i.extend({cfg:i.extend({format:c}),encrypt:function(t,e,i,n){n=this.cfg.extend(n);var r=t.createEncryptor(i,n);return e=r.finalize(e),r=r.cfg,f.create({ciphertext:e,key:i,iv:r.iv,algorithm:t,mode:r.mode,padding:r.padding,blockSize:t.blockSize,formatter:n.format})},decrypt:function(t,e,i,n){return n=this.cfg.extend(n),e=this._parse(e,n.format),t.createDecryptor(i,n).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t,this):t}})),d=(d.kdf={}).OpenSSL={execute:function(t,e,i,r){return r||(r=n.random(8)),t=o.create({keySize:e+i}).compute(t,r),i=n.create(t.words.slice(e),4*i),t.sigBytes=4*e,f.create({key:t,iv:i,salt:r})}},l=e.PasswordBasedCipher=p.extend({cfg:p.cfg.extend({kdf:d}),encrypt:function(t,e,i,n){return i=(n=this.cfg.extend(n)).kdf.execute(i,t.keySize,t.ivSize),n.iv=i.iv,(t=p.encrypt.call(this,t,e,i.key,n)).mixIn(i),t},decrypt:function(t,e,i,n){return n=this.cfg.extend(n),e=this._parse(e,n.format),i=n.kdf.execute(i,t.keySize,t.ivSize,e.salt),n.iv=i.iv,p.decrypt.call(this,t,e,i.key,n)}})}(),function(){for(var t=CryptoJS,e=t.lib.BlockCipher,i=t.algo,n=[],r=[],s=[],o=[],a=[],c=[],u=[],h=[],f=[],p=[],d=[],l=0;256>l;l++)d[l]=128>l?l<<1:l<<1^283;var _=0,g=0;for(l=0;256>l;l++){var m=(m=g^g<<1^g<<2^g<<3^g<<4)>>>8^255&m^99;n[_]=m,r[m]=_;var y=d[_],v=d[y],S=d[v],k=257*d[m]^16843008*m;s[_]=k<<24|k>>>8,o[_]=k<<16|k>>>16,a[_]=k<<8|k>>>24,c[_]=k,k=16843009*S^65537*v^257*y^16843008*_,u[m]=k<<24|k>>>8,h[m]=k<<16|k>>>16,f[m]=k<<8|k>>>24,p[m]=k,_?(_=y^d[d[d[S^y]]],g^=d[d[g]]):_=g=1}var w=[0,1,2,4,8,16,32,64,128,27,54];i=i.AES=e.extend({_doReset:function(){for(var t=(i=this._key).words,e=i.sigBytes/4,i=4*((this._nRounds=e+6)+1),r=this._keySchedule=[],s=0;s<i;s++)if(s<e)r[s]=t[s];else{var o=r[s-1];s%e?6<e&&4==s%e&&(o=n[o>>>24]<<24|n[o>>>16&255]<<16|n[o>>>8&255]<<8|n[255&o]):(o=n[(o=o<<8|o>>>24)>>>24]<<24|n[o>>>16&255]<<16|n[o>>>8&255]<<8|n[255&o],o^=w[s/e|0]<<24),r[s]=r[s-e]^o}for(t=this._invKeySchedule=[],e=0;e<i;e++)s=i-e,o=e%4?r[s]:r[s-4],t[e]=4>e||4>=s?o:u[n[o>>>24]]^h[n[o>>>16&255]]^f[n[o>>>8&255]]^p[n[255&o]]},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._keySchedule,s,o,a,c,n)},decryptBlock:function(t,e){var i=t[e+1];t[e+1]=t[e+3],t[e+3]=i,this._doCryptBlock(t,e,this._invKeySchedule,u,h,f,p,r),i=t[e+1],t[e+1]=t[e+3],t[e+3]=i},_doCryptBlock:function(t,e,i,n,r,s,o,a){for(var c=this._nRounds,u=t[e]^i[0],h=t[e+1]^i[1],f=t[e+2]^i[2],p=t[e+3]^i[3],d=4,l=1;l<c;l++){var _=n[u>>>24]^r[h>>>16&255]^s[f>>>8&255]^o[255&p]^i[d++],g=n[h>>>24]^r[f>>>16&255]^s[p>>>8&255]^o[255&u]^i[d++],m=n[f>>>24]^r[p>>>16&255]^s[u>>>8&255]^o[255&h]^i[d++];p=n[p>>>24]^r[u>>>16&255]^s[h>>>8&255]^o[255&f]^i[d++],u=_,h=g,f=m}_=(a[u>>>24]<<24|a[h>>>16&255]<<16|a[f>>>8&255]<<8|a[255&p])^i[d++],g=(a[h>>>24]<<24|a[f>>>16&255]<<16|a[p>>>8&255]<<8|a[255&u])^i[d++],m=(a[f>>>24]<<24|a[p>>>16&255]<<16|a[u>>>8&255]<<8|a[255&h])^i[d++],p=(a[p>>>24]<<24|a[u>>>16&255]<<16|a[h>>>8&255]<<8|a[255&f])^i[d++],t[e]=_,t[e+1]=g,t[e+2]=m,t[e+3]=p},keySize:8});t.AES=e._createHelper(i)}(),CryptoJS.pad.ZeroPadding={pad:function(t,e){var i=4*e;t.clamp(),t.sigBytes+=i-(t.sigBytes%i||i)},unpad:function(t){for(var e=t.words,i=t.sigBytes-1;!(e[i>>>2]>>>24-i%4*8&255);)i--;t.sigBytes=i+1}};import storage from"@system.storage";import nativeFetch from"@system.fetch";import device from"@system.device";import geolocation from"@system.geolocation";import network from"@system.network";import account from"@service.account";import shortcut from"@system.shortcut";import md5 from"md5";import app from"@system.app";import router from"@system.router";import APP_CONFIG from"./statistics.config";!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.APP_STATISTICS=e()}(this,function(){"use strict";function t(t){let e="";for(let i in t)e+=i+"="+t[i]+"&";return e=e.substring(0,e.length-1)}function e(t,e){let i=CryptoJS.enc.Latin1.parse(e),n=CryptoJS.enc.Latin1.parse(e);return CryptoJS.AES.encrypt(t,i,{iv:n,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.ZeroPadding}).toString()}function i(){return(268435456*(1+Math.random())|0).toString(16)}const n={get:function(t){let{url:e,timeout:i}=t,n=new Promise((t,i)=>{nativeFetch.fetch({url:config.url+e,success:function(e){t(e)},fail:function(e,i){t(e)}})}),r=new Promise((t,e)=>{setTimeout(()=>{t({code:204,massage:"请求超时"})},3e3)});return Promise.race([r,n])}};function r(t){return n.get({url:"/a.gif?"+t})}function s(...t){return new Promise((e,i)=>{storage.set({key:t[0],value:t[1]||"",success:function(t){e(!0)},fail:function(t,i){e(!1)}})})}function o(t){return new Promise((e,i)=>{storage.get({key:t,success:function(t){e(t)},fail:function(t,i){e(!1)}})})}const a={deviceIds:()=>new Promise((t,e)=>{device.getId({type:["device","mac","user"],success:function(e){t(e)},fail:function(e,i){t({})}})}),deviceInfos:()=>new Promise((t,e)=>{device.getInfo({success:function(e){t(e)},fail:function(){t({})}})}),netType:()=>new Promise((t,e)=>{network.getType({success:function(e){t(e)},fail:function(){t({})}})}),has_shortcut:()=>new Promise((t,e)=>{shortcut.hasInstalled({success:function(e){t({has_iocn:e})},fail:function(e){t({has_iocn:0})}})})},c="_SD_BD_CUID_",u="_SD_BD_PAGE_START_",h={sdk_vision:"1.2.0.0",debug:0},f={has_init:!1,has_cuid_storage:!1,has_request_id_storage:!1};const p={device:(t,i)=>({package:t.package||"",channel:t.channel||"",name:t.name||"",svr:t.versionName||"",client_id:e(t.device||"",i),info_ma:e(t.mac||"",i),os_id:t.user||"",make:(t.brand||"").toLowerCase(),manufacturer:(t.manufacturer||"").toLowerCase(),model:(t.model||"").toLowerCase(),product:(t.product||"").toLowerCase(),os_type:t.osType||"",ovr:t.osVersionName||"",pla_ver:t.platformVersionName||"",lan:(t.language||"").toLowerCase(),region:(t.region||"").toLowerCase(),px:`${t.screenWidth||""}*${t.screenHeight||""}`,net:t.type||"",has_iocn:t.has_iocn||0}),page:t=>({page_name:"",page_path:"",sta_time:"",end_time:"",duration:"",is_entry:0}),public:t=>({app_id:APP_CONFIG.app_key||"",cuid:t.cuid,req_id:t.req,en_code:"cuid"})};let d=new class{constructor(){this.state={data:null,page:null,is_entry:1,cuid:"",req:"",log_list:[]},this.init=this.init.bind(this),this.page_stat=this.page_stat.bind(this),this.page_end=this.page_end.bind(this),this.merge_datas=this.merge_datas.bind(this),this.save_to_queue=this.save_to_queue.bind(this)}init(t){f.has_init=!0;let e={},n=t||{_def:{}};n._def=n._def||{manifest:{}};let{_def:{manifest:r}}=n,u=app.getInfo();e.package=r.package||u.packageName,e.versionName=r.versionName||u.versionName,e.minPlatformVersion=r.minPlatformVersion,e.channel=account.getProvider(),e.name=r.name||u.name,Promise.all([a.deviceInfos(),a.deviceIds(),a.netType(),a.has_shortcut()]).then(t=>{let n=Object.assign(e,...t),r={};o(c).then(t=>{r.cuid=t||function(t){let e=t||i();return md5(Date.now()+"-"+i()+"-"+i()+"-"+i()+"-"+e)}(n.client_id||""),this.state.cuid=r.cuid,r.req=this.state.req=function(t){let e=Date.now()+i()+i()+(t||i());return md5(e)}(r.cuid),this.state.data={...p.device(n,this.state.cuid),...p.public(r)},s(c,r.cuid).then(t=>{t&&(f.has_cuid_storage=!0)})})})}page_stat(t){let{name:e,path:i}=router.getState();this.state.page={sta_time:Date.now(),page_path:e||"",page_path:i||"",is_entry:this.state.is_entry||0},this.state.is_entry=0,s(u,this.state.page).then(t=>{})}page_end(t){if(!this.state.cuid&&!this.state.data)return;let e=Date.now();this.state.page?(this.state.page.duration=e-this.state.page.sta_time,this.state.page.end_time=e,this.merge_datas()):o(u).then(t=>{let i=JSON.parse(t);if(i){i.duration=e-i.sta_time;let t=Object.assign(i,{end_time:e});this.state.page=t,this.merge_datas()}})}merge_datas(){let e={};this.state.data&&this.state.page&&r(t(e={...this.state.data,...this.state.page,...h})).then(i=>{200==i.code?this.send_queue():this.save_to_queue(t(e))}).catch(i=>{this.save_to_queue(t(e))})}save_to_queue(e){let i=this.state.log_list&&this.state.log_list.length;return i&&i<50&&this.state.log_list.push(t(log_data)),this.state.log_list}send_queue(){let t=[...this.state.log_list];this.state.log_list=[],t.forEach(t=>{r(t).then(e=>{200!=e.code&&save_to_queue(t)}).catch(e=>{save_to_queue(t)})})}};const l={open_app(t){try{if(e=u,new Promise((t,i)=>{storage.delete({key:e,success:function(e){t(e)},fail:function(e,i){t(!1)}})}),!APP_CONFIG.app_key)return void console.error("没有填写 app_key ！");d.init(t)}catch(t){}var e},page_show(t){try{f.has_init&&d.page_stat(t)}catch(t){}},page_hide(t){try{f.has_init&&d.page_end(t)}catch(t){}},custom_track(t,e){}},_=global.__proto__||global;return _.APP_STATISTICS={app_sta_init:l.open_app,page_show:l.page_show,page_hide:l.page_hide},_.Custom_page=function(t){let e=t.onShow,i=t.onHide;return t.onShow=function(){l.page_show(this),e&&e.call(this)},t.onHide=function(){l.page_hide(this),i&&i.call(this)},t},{app_sta_init:l.open_app,page_show:l.page_show,page_hide:l.page_hide}});
//# sourceMappingURL=appStatistics.min.js.map
